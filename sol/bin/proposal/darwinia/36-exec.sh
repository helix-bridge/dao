#!/usr/bin/env bash

set -eox pipefail

ETH_FROM=0x7aE77149ed38c5dD313e9069d790Ce7085caf0A6
WALLET=0xBd1a110ec476b4775c43905000288881367B1a88
PAIR=0xdfA67E8f80F6B37a21e5C3baeEb0eCa893652Ab9
ROUTER=0xB899409cDA0fFA2bF87F9c7b31f3c77D6A3a0bB0
TIMELOCK=0xA546F42BeB3DEa617b0F3Ca6995C7Df5dfCaD29D
xWCRAB=0x656567eb75b765fc320783cc6edd86bd854b2305
WRING=0xe7578598aac020abfb918f33a20fad5b71d670b4
SALT=0x0000000000000000000000000000000000000000000000000000000000000024
PREDECESSOR=0x0000000000000000000000000000000000000000000000000000000000000000
DELAY=1800
DEADLINE=1712682153

cal() {
  python3 -c "print(int($1))"
}

targets=[$PAIR,$ROUTER]
values=[0,0]

datas=[0x095ea7b3000000000000000000000000b899409cda0ffa2bf87f9c7b31f3c77d6a3a0bb00000000000000000000000000000000000000000000a70986923c65af2d18ed0,0xbaa2abde000000000000000000000000e7578598aac020abfb918f33a20fad5b71d670b4000000000000000000000000656567eb75b765fc320783cc6edd86bd854b23050000000000000000000000000000000000000000000a70986923c65af2d18ed0000000000000000000000000000000000000000000026d31156d93c3600000000000000000000000000000000000000000000000002c25024085be5800000000000000000000000000000000a546f42beb3dea617b0f3ca6995c7df5dfcad29d00000000000000000000000000000000000000000000000000000000661574a9]

# seth send -F $ETH_FROM $WALLET "submitTransaction(address,uint,bytes)" $TIMELOCK 0 $data --chain darwinia
# count=$(seth call $WALLET "transactionCount()(uint)" --chain darwinia)
# seth call $WALLET "transactions(uint)(address,uint,bytes,bool)" $(( $count - 1 )) --chain darwinia

id=$(seth call $TIMELOCK "hashOperationBatch(address[],uint256[],bytes[],bytes32,bytes32)" $targets $values $datas $PREDECESSOR $SALT --chain darwinia)
date -r $(seth call $TIMELOCK "getTimestamp(bytes32)(uint)" $id --chain darwinia) '+%Y-%m-%d %H:%M:%S'

seth send -F $ETH_FROM $TIMELOCK "executeBatch(address[],uint256[],bytes[],bytes32,bytes32)" $targets $values $datas $PREDECESSOR $SALT --chain darwinia
